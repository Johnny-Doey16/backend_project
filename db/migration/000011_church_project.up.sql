CREATE TABLE IF NOT EXISTS church_projects (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  church_id INT NOT NULL,
  project_name VARCHAR(255) NOT NULL,
  project_description TEXT,
  target_amount DECIMAL(10,2) NOT NULL,
  donated_amount DECIMAL(10,2) NOT NULL,
  start_date DATE,
  end_date DATE,
  visibility BOOLEAN DEFAULT TRUE,
  completed BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ,
  FOREIGN KEY (church_id) REFERENCES churches(id)
);

CREATE TABLE IF NOT EXISTS project_donations (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  project_id INT NOT NULL,
  user_id UUID NOT NULL,
  donation_amount DECIMAL(10,2) NOT NULL,
  donated_at TIMESTAMPTZ DEFAULT NOW(),
  FOREIGN KEY (project_id) REFERENCES church_projects(id),
  FOREIGN KEY (user_id) REFERENCES authentications(id)
);

CREATE TABLE IF NOT EXISTS church_programs (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  church_id INT NOT NULL,
  program_type VARCHAR(100) NOT NULL, -- special event, retreat, mass,
  program_name VARCHAR(255) NOT NULL, -- harvest, bazaar, spiritual retreat, sunday mass,
  program_desc TEXT,
  program_day VARCHAR(20), -- Day of the week for recurring events other "2023-10-11" 
  program_start_time TIME,
  program_end_time TIME,
  program_freq VARCHAR(50), -- e.g., "Weekly", "Monthly"
  program_image_url VARCHAR(255),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  FOREIGN KEY (church_id) REFERENCES churches(id)
);

CREATE INDEX ON "church_projects" ("church_id");

CREATE INDEX ON "project_donations" ("project_id", "user_id");

CREATE INDEX ON "church_programs" ("church_id");
